<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <title>CTI Dashboard - {% block title %}{% endblock %}</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap"
      rel="stylesheet"
    >

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Core styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/animations.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/premium-enhance.css') }}">

    {% block head %}{% endblock %}
</head>

<body class="bg-body">

<div class="app-shell d-flex page-animate">

  <!-- Sidebar -->
  <aside class="sidebar d-flex flex-column p-3" id="sidebar">
    <div class="d-flex align-items-center mb-4">
      <div class="logo-glow me-2"></div>
      <div>
        <div class="sidebar-title">CTI Premium</div>
        <div class="sidebar-subtitle">Threat Intelligence</div>
      </div>
    </div>

    {% if current_user.is_authenticated %}
    <nav class="flex-grow-1">
      <ul class="nav nav-pills flex-column gap-1">

        <li class="nav-item">
          <a href="{{ url_for('dashboard.home') }}"
             class="nav-link sidebar-link {% if request.endpoint.startswith('dashboard') %}active{% endif %}">
            ğŸ›¡ Dashboard
          </a>
        </li>

        <li class="nav-item">
          <a href="{{ url_for('ioc.lookup') }}"
             class="nav-link sidebar-link {% if request.endpoint.startswith('ioc') %}active{% endif %}">
            ğŸ” IOC Lookup
          </a>
        </li>

        <li class="nav-item">
          <a href="{{ url_for('tickets.list_tickets') }}"
             class="nav-link sidebar-link {% if request.endpoint.startswith('tickets') %}active{% endif %}">
            ğŸ« Tickets
          </a>
        </li>

        <li class="nav-item">
          <a href="{{ url_for('feeds.feeds_home') }}"
             class="nav-link sidebar-link {% if request.endpoint.startswith('feeds') %}active{% endif %}">
            ğŸŒ Threat Feeds
          </a>
        </li>

        <!-- ğŸ” ADMIN ONLY -->
        {% if current_user.is_admin %}
        <li class="nav-item mt-2">
          <a href="{{ url_for('auth.admin_users') }}"
             class="nav-link sidebar-link {% if request.endpoint == 'auth.admin_users' %}active{% endif %}">
            ğŸ‘¤ User Management
          </a>
        </li>
        {% endif %}
        {% if current_user.is_admin %}
<li class="nav-item">
  <a href="{{ url_for('auth.audit_logs') }}"
     class="nav-link sidebar-link">
    ğŸ§¾ Audit Logs
  </a>
</li>
{% endif %}


      </ul>
    </nav>

    <div class="mt-auto pt-3 border-top border-secondary border-opacity-25">
      <div class="small text-muted mb-1">Signed in as</div>
      <div class="fw-semibold text-light mb-3">
        {{ current_user.username }}
      </div>

      <a href="{{ url_for('auth.logout') }}"
         class="btn btn-outline-light btn-sm w-100 mb-2">
        Logout
      </a>

      <button type="button"
              class="btn btn-outline-secondary btn-sm w-100"
              id="themeToggle">
        Toggle Theme
      </button>
    </div>
    {% endif %}
  </aside>

  <!-- Main content -->
  <main class="main-panel flex-grow-1">
    <div class="main-inner page-animate">
      {% block content %}{% endblock %}
    </div>
  </main>

</div>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="{{ url_for('static', filename='js/darkmode.js') }}"></script>

{% block scripts %}{% endblock %}
</body>
</html>
